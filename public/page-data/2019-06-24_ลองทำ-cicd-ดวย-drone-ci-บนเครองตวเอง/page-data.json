{"componentChunkName":"component---src-templates-blog-post-js","path":"/2019-06-24_ลองทำ-cicd-ดวย-drone-ci-บนเครองตวเอง/","result":{"data":{"site":{"siteMetadata":{"title":"Miwtoo Blog"}},"markdownRemark":{"id":"e43adb6d-cc9c-5558-8907-3fd5aa31b06f","excerpt":"https://drone.io/ ปัจจุบันการทำ CI/CD เข้ามาช่วยให้การทำ ซอฟแวร์ง่ายขึ้นเยอะ โดยแต่ล่ะขั้นตอนจะเป็นการทำงานแบบ automated tools ทั้ง build, test ไปจนถึง deploy…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bfbe4974241d221476638dc8022a7a13/c1b63/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAACLElEQVQozz1SiWrbQBTU95Z+T+lBS3rRwwklLaEECil1EjuQOHVdJ3FkRbZ1WMfq2JW0t7R9CiUwPGZ33+wO89ZqhMZUIsITzOOSxSUPsibMWYxVWMqwECFWM7dY+OQu5U7CXSSdVNxs2fWWWbozESLD86vTy8V4uhz9tg+Pp8OJ7aEaVSrCejTxBnsnx5fBOmV+xs5nwcWiXGdiGTPLGIMr+vd2c7X0nE20cMO57cFyvc25NknBP+z/8ZM6KmVMVICapRsf/NqMZ4lfql5sutYYbTqtlGQcIBomuNRSd0J134/sspLamEYazDtuzP4PezgJM9r1Yjeiu8N4MEynDs5JHaIqwwxTldcSM31xFb/5Mnk7GL/+fPZud/zy0/jbTwcRVTa6F59e14+frh89WX09K3Jcu9sSVSKvFHhOG+OvgoMX73f2Rs92Dl8NTvaef5yPLrbMeIhbuJYZEZjqolGAkrZF00JUKZEJkRHRcYZxjkptsOoyaVBW+BG6Q8qGwNKSh4gXjc5rBZrkXhNjGWEJowpyEWDllWqVUieiy6hxkFoiCVHDtKwCNET2qOTDg9tCBJnwEQdvm4TehfXNitx6le33mLt45pL+5ZrrimsMhus+g3tAVP8BjuDeqOAwuPTeEdwLHCr8H4urjgpdM0VFy2ULH65iGipXLWwSKplsgUNPXkk4gh4C+0w1XFuqhWG2lGuoSndMaujredtz0EvVwcCBPHBoAEjV/gPEPpSJhQLoaAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/bfbe4974241d221476638dc8022a7a13/fcda8/1.png\"\n        srcset=\"/static/bfbe4974241d221476638dc8022a7a13/12f09/1.png 148w,\n/static/bfbe4974241d221476638dc8022a7a13/e4a3f/1.png 295w,\n/static/bfbe4974241d221476638dc8022a7a13/fcda8/1.png 590w,\n/static/bfbe4974241d221476638dc8022a7a13/efc66/1.png 885w,\n/static/bfbe4974241d221476638dc8022a7a13/c83ae/1.png 1180w,\n/static/bfbe4974241d221476638dc8022a7a13/c1b63/1.png 1200w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a href=\"https://drone.io/\">https://drone.io/</a></p>\n<p>ปัจจุบันการทำ CI/CD เข้ามาช่วยให้การทำ ซอฟแวร์ง่ายขึ้นเยอะ โดยแต่ล่ะขั้นตอนจะเป็นการทำงานแบบ automated tools ทั้ง build, test ไปจนถึง deploy</p>\n<p>โดยส่วนตัวนั้นมีโอกาศได้ลองศึกษา <a href=\"https://drone.io/\">Drone CI</a> จากโปรเจคที่อาจารย์ให้ไปศึกษา Software ในกลุ่มของ <a href=\"https://landscape.cncf.io/\">CNCF</a> โดยเลือกมาหนึ่งตัว แล้วก็เลือก <a href=\"https://drone.io/\">Drone CI</a> มาศึกษา (จากคที่โลโก้มันเหมือนโปเกม่อน 5555) จากนั้นก็มาทำบล็อกใว้เพื่อเก็บใว้เผื่อเก็บใว้อ่านเอง และแชร์สิ่งได้รู้มา</p>\n<p>Drone CI สร้างขึ้นในปี 2012 ถือเป็นหนึ่งใน Container-Native ถูกจัดอยู่ในกลุ่มของ Continuous Integration &#x26; Delivery และเป็น Open Source มีความสามารถในการ เป็น โปรแกรมทดสอบซอฟแวร์อัตโนมัติ CI/CD ตามที่ถูกจัดกลุ่มใว้</p>\n<p>ข้อดีของ Drone CI คือ เขียน ตั้งค่าตัว Pipelines ง่าย และอ่านง่าย โดยที่แต่ล่ะขั้นตอนของ Pipeline จะมี Docker container แยก และดาวโหลอัตโนมัติเวลาที่ทำงาน และ สามารถใช้งานกับ โปรแกรมจัดการโค้ดตัวไหนก็ได้ ทำงานบน แพทฟอร์มไหนก็ได้ ใช้งานกับภาษาไหนก็ได้ที่มี Docker container สนับสนุน รวมทั้งมี Plugins ให้เลือกใช้มากมาย หากไม่พอกับการใช้งานสามารถสร้างเองได้ การ Scale ที่ง่าย และจะ scales อันโนมัติ อีกทั้ง มี cloud ของตัวเอง สามารถใช้งานฟรีได้ทันที</p>\n<p><strong>Feature ที่น่าสนใจ</strong></p>\n<p>สามารถใช้งานกับ Source Code Manager ตัวไหนก็ได้ ที่อยู่บนพื้นฐานของ git เช่น GitHub, GitLab ทั้ง self-host git ก็ยังใช้งานได้ ตัว server รันได้กับทั้ง Linux และ Windows มี ฐานข้อมูลในตัว Sqlite, MySQL, Postgres สามารถทำ Clustering บน Agents, Kubernetes, Nomad ได้ หรืออาจจะรันแบบ Single Machine ก็ได้ สามารถทำ Scheduling บน cron-job ได้ มี Plugins มากมายทั้ง Pipeline Plugins , Custom Secret Plugins, Custom Registry Plugins, Custom Yaml Plugins, Custom Access Control Plugins เก็บความลับของเราด้วยการเข้ารหัสได้หลากหลายแบบ และการ autoscaling บน หลากหลาย แพทฟอร์ม เช่น Amazon EC2, Digital Ocean, Google Compute</p>\n<p>วันนี้จะมาลองสร้าง self-hosted ของ Drone บน Windows โดยใช้ <a href=\"https://hub.docker.com/editions/community/docker-ce-desktop-windows\">Docker</a> และ <a href=\"https://ngrok.com/\">ngrok</a> โดยเชื่อมต่อกับ Github เพื่อลองศึกษาการทำ self-hosted บนเครื่องของตัวเอง</p>\n<h3><strong>วิธีการติดตั้ง</strong></h3>\n<h4>เครื่องมือที่ใช้</h4>\n<ul>\n<li><em>Drone CI</em> <code class=\"language-text\">_1.0_</code></li>\n<li><em>Docker Desktop Community</em><code class=\"language-text\">_2.0.0.3 (31259)_</code></li>\n<li><em>Ngrok</em> <code class=\"language-text\">2.3.30</code></li>\n</ul>\n<p>ในทีนี้เป็นการติดตั้ง แบบ Single Machine เชื่อมต่อกับ GitHub สามารถดูเพิ่มเติมได้ <a href=\"https://docs.drone.io/installation/github/single-machine/\">ที่นี้</a></p>\n<p>ก่อนอื่นเลยให้เรา สร้าง url แบบสาธารณะ โดยใช้ ngrok ด้วยคำสั่ง ผ่าน cmd</p>\n<blockquote>\n<p>ngrok http 80</p>\n</blockquote>\n<p>จะได้หน้าตาแบบนี้</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/533642b4d84e7315d13b015e599d11fe/4597d/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABVUlEQVQY001P2WrCQBSdb3OZSSaLmsQlCWYbUWpNqoVIo36eb/5EsT5Ug0+CUhTscaTQw2G498xdziWf2+2+LL8Ph71kWZbH43EvcblcTqfTZrNZr9dfu939fr9er7fb7Xw+/0iQ7H32VnykeZ7O5+DrZDIej18ksixL03QgRBLHkGbTaZ7ny+WyKIrVarVYLEhdr1XNal2pMcrqErRJqU5VReGqChqapnOuMlatVGr/YJomcT2Xa9yQ0CXEQIRRaNu273m2ZdmtFthqNDRV1bUHUIO30+mQKIp6vR7GIOecQ4ZPiEKIEAgCXYqgaRim3PGsbLfbZDQa9fv9R5uOMo4PIZtx83A4xP2+77uuG8dxFIYDCcuyFEVxHId0u10kqgRjDC9SDMILO9YfbMcBYRUXoJNSCpFgqud5GIEPOEGAVTgEIoKnf1gIgiBJEqQIsBOV8PsLtGrF2N9QO20AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/533642b4d84e7315d13b015e599d11fe/fcda8/2.png\"\n        srcset=\"/static/533642b4d84e7315d13b015e599d11fe/12f09/2.png 148w,\n/static/533642b4d84e7315d13b015e599d11fe/e4a3f/2.png 295w,\n/static/533642b4d84e7315d13b015e599d11fe/fcda8/2.png 590w,\n/static/533642b4d84e7315d13b015e599d11fe/4597d/2.png 631w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>ก่อนที่จะลงรันให้เชื่อมต่อกับ GitHub ได้เราจะติองมี OAuth Application ก่อน เพื่อให้ได้ Client ID และ Client Secret</p>\n<ol>\n<li><strong>สร้าง OAuth Application ใน GitHub</strong>\nต้องกรอก Authorization callback ให้ตรงตามรูปแบบ ในรูป</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/87f01e94caa51e53248964b6ad3c1432/30d16/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.48648648648648%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAABrUlEQVQ4y41Sa4sUMRC8//9JBOVAEISDQ/H3+Dg9vVvXncm8Mnl30unEntlVV9llr6jpGQI13dWpq1prKaXWv+/yG/USrvgx1j5utk3bynluu4652zWi7TabH00rmqZFzOtPT4kTojHGWeu9w5QKUaFMlHNGWj9YWA+z/cO1swtfvjdboZpea5dtrBYWmlB0KEv1pBw5oBOdIeZtO486SYNi9Mxu8oNKs6M/lJZMyKfEIYwrtFIYGRAhIOKTFgYAP5uW2fWDsS4mZItUSsL8H0+Iuck0SaWUlKrrx0nO2lilDS8SeWlHPDP2MEg5M6dp4rlZxfXiVe8XFoeRhZo7T7OCmJiYqTzFM8/jAvgDo/NgnWde3NkakpQsm1TKcNZWeueNNgDxsjiEIARveuz7QXQdGyi02F3yTYecU9mfnfK8E2LXiSXVomtEL5WGiA7QA7rANQWIHoATe7zFRVypUsjkM0VCh+DBc9AdzBaZHDvtIhvhI2vMXr/HIv6gvz7/dvPy4fb64e2z+zePtg1Q6cw9lSMs4k/z/fXn21d3717fvX/x8WajRYxnxcf4BctZ25d1tdAwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/87f01e94caa51e53248964b6ad3c1432/fcda8/3.png\"\n        srcset=\"/static/87f01e94caa51e53248964b6ad3c1432/12f09/3.png 148w,\n/static/87f01e94caa51e53248964b6ad3c1432/e4a3f/3.png 295w,\n/static/87f01e94caa51e53248964b6ad3c1432/fcda8/3.png 590w,\n/static/87f01e94caa51e53248964b6ad3c1432/30d16/3.png 672w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Application name: ตั้งชื่อได้ตามใจชอบ<br>\nHomepage URL: ใส่ URL ของ ngrok<br>\nAuthorization callback URL: ใส่ URL ของ ngrok ตามด้วย /login<br>\nแล้วกด Register application ได้เลย</p>\n<p>แล้วจะได้ Client ID และ Client Secret มา เพื่อนำมาใช้ในขั้นตอนต่อไป</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 388px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8762f11984d8b63481b660d8f2fba1ba/96c67/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.45945945945946%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABXklEQVQoz6WQy07CQBSGeS94CHYSnsCEBSZSJZEN4AKXAolKiLHsIAUkRmFVNUi89A1EgZbKQDsl0Nray5Q6oKJhg8q3mDM5c77Mye9yVsAlDMDjc9vQzfFYlmXFsqw/yFAUWx0We8JAhFDSNG3yxXL5o/xyelEeShJNX97e3V/PoGmaYZhm84njOITQErnfByR5ksvlQqFNn2/N4/G43W6v1xuLxVVVtW3b+gGasbj2P9NmmIfwdjiyEyFCBP4tnU4X8vkiRR0eHGQymVQqFYtGtzAEsREM+v3+vURiHpMLAHBRq1Hlcp6iSpXT82q13mhc3dQrZ1PwWSgVj0nyKJuN7sbXA4H9ZPJbxsWWFWekOK/aRNEcVUcj2RSGjm5OJ3Rjgp/eDNx3LIQvSLeQbX+ubSJbAgOxxYosD3kAuz3pBYhtDvb6mm6M4FBocRB3WF7s9mCHh0Cw5vIqgb0DzQuJYbagupcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/8762f11984d8b63481b660d8f2fba1ba/96c67/4.png\"\n        srcset=\"/static/8762f11984d8b63481b660d8f2fba1ba/12f09/4.png 148w,\n/static/8762f11984d8b63481b660d8f2fba1ba/e4a3f/4.png 295w,\n/static/8762f11984d8b63481b660d8f2fba1ba/96c67/4.png 388w\"\n        sizes=\"(max-width: 388px) 100vw, 388px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"2\">\n<li><strong>เขียนไฟล์ docker-compose.yaml</strong></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'2'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">drone-server</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> drone\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> drone/drone<span class=\"token punctuation\">:</span><span class=\"token number\">1</span>\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"80:80\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"443:443\"</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n      <span class=\"token punctuation\">-</span> ./data<span class=\"token punctuation\">:</span>/var/lib/drone/\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> DRONE_GIT_ALWAYS_AUTH=false\n      <span class=\"token punctuation\">-</span> DRONE_TLS_AUTOCERT=false\n      <span class=\"token punctuation\">-</span> DRONE_GITHUB_SERVER=https<span class=\"token punctuation\">:</span>//github.com\n      <span class=\"token punctuation\">-</span> DRONE_GITHUB_CLIENT_ID= กรอก Client ID\n      <span class=\"token punctuation\">-</span> DRONE_GITHUB_CLIENT_SECRET= กรอก Client Secret\n      <span class=\"token punctuation\">-</span> DRONE_RUNNER_CAPACITY=2 \n      <span class=\"token punctuation\">-</span> DRONE_SERVER_HOST=fbeb1796.ngrok.io\n      <span class=\"token punctuation\">-</span> DRONE_SERVER_PROTO=http</code></pre></div>\n<p>โดยให้กรอก Client ID และ Client Secret และ Sever Host จาก URL ของ ngrok โดยไม่ต้องใส่ protocol ใว้ข้างหน้า</p>\n<p>จากนั้นสั้ง</p>\n<blockquote>\n<p>docker-compose up</p>\n</blockquote>\n<p>จะได้หน้าตาประมาณนี้</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ac71fa5338061663c3b8f7c04c1a0f40/f43e4/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.594594594594593%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAu0lEQVQI1yWO3Q6CMAyFeTO9wMlmgG5gnONnEMd7ccUVoAiBQMK7WceXpjntadLjDMPwRUZb2Maxbdu+77uu6/90n/d7nudpmpZlaZqmrut937dtW9fVKV9GSinuEXDgnPu+f7NQz7taKKWMMRQX1716fwghh+VIXQGA1qUxpqqqoii01nmep1n6VIlMMpWhzpM0VUrFcYzHQojI4kT3B/7hdkaPW9AOAcgtPLPwxIAEIgCOG4/SI8sR5wchlGKhfpQihwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/ac71fa5338061663c3b8f7c04c1a0f40/fcda8/5.png\"\n        srcset=\"/static/ac71fa5338061663c3b8f7c04c1a0f40/12f09/5.png 148w,\n/static/ac71fa5338061663c3b8f7c04c1a0f40/e4a3f/5.png 295w,\n/static/ac71fa5338061663c3b8f7c04c1a0f40/fcda8/5.png 590w,\n/static/ac71fa5338061663c3b8f7c04c1a0f40/efc66/5.png 885w,\n/static/ac71fa5338061663c3b8f7c04c1a0f40/f43e4/5.png 1120w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3><strong>วิธีการใช้งานเบื้องต้น</strong></h3>\n<ol>\n<li>**เข้าเว็บไซต์ของเราที่เชื่อมต่อกับ server\n**จาก URL ของ ngrok</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/142179936c952c80cd7e9864406a4b1c/5a190/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAA50lEQVQoz32RS0/DMBCE8zvTVlyqXvpASIVDe25SJIoE/xRqe192YJKUAMFl9R0ie2d3xinKVTVZ16BcHSabqlzXN3ePy/3rcveyeHieb5/m29Ps9tg1VEPzdFMv7k8FsYJA+nYOgYTFQH/Yf/eomPP07ohELxLWYuiGsr1Ra5qPjnGpJZL0c+KwWTAYYu8xwNKfahJk0dPFVM+3+OyC861zEYspjUAFtmti9YEhZRE4TLkSjcxXNg+Zv2yOEW2d58XI7ANic4wpC27+yUzOBeiznrGaugfjbOb2x7IAs5jdrMgsvzZ/Aq62Ke+p2SY9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/142179936c952c80cd7e9864406a4b1c/fcda8/6.png\"\n        srcset=\"/static/142179936c952c80cd7e9864406a4b1c/12f09/6.png 148w,\n/static/142179936c952c80cd7e9864406a4b1c/e4a3f/6.png 295w,\n/static/142179936c952c80cd7e9864406a4b1c/fcda8/6.png 590w,\n/static/142179936c952c80cd7e9864406a4b1c/5a190/6.png 800w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"2\">\n<li>กดเข้าไปที่ repository ที่ต้องการ แล้วกด Activate repository</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/008e16bc92fc11f953f38416cb6bbdca/5a190/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.5945945945946%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAAzElEQVQoz42R4Q4BMQyAvT2JxIOQ8CKE/0L4c8fZxs3uZlvb07Egh7B8a7qmX7NsHXvxpXHaeG3sSVdMqavaOq7/pMP7IMtClrtCFeKY76U6nf8xkyxUlPNCZXshleYrcLG2kcqm5J0kOx+YENAHDEC3BBhCJuUtnIckN2+LKMatwI2AePzQQN/lW9xI2h7gMeu3fO9T59Af571R1h1mg8nOemyNeMpI9Ao1VDucr6rZ0kyXZrE2HmL5tQcQk9yi5id0fB24Qw1cvnzVFWvTCiFblALMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/008e16bc92fc11f953f38416cb6bbdca/fcda8/7.png\"\n        srcset=\"/static/008e16bc92fc11f953f38416cb6bbdca/12f09/7.png 148w,\n/static/008e16bc92fc11f953f38416cb6bbdca/e4a3f/7.png 295w,\n/static/008e16bc92fc11f953f38416cb6bbdca/fcda8/7.png 590w,\n/static/008e16bc92fc11f953f38416cb6bbdca/5a190/7.png 800w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"3\">\n<li>สร้างไฟล์ .drone.yml ใน repository (ตัวอย่าง การ install, test และ build Angular จาก นั้น deploy ไปที่ github page)</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> pipeline\n<span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> default\n\n<span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> install\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> johnpapa/angular<span class=\"token punctuation\">-</span>cli\n  <span class=\"token key atrule\">commands</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> npm install\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> test\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> trion/ng<span class=\"token punctuation\">-</span>cli<span class=\"token punctuation\">-</span>karma<span class=\"token punctuation\">:</span>6.2.1\n  <span class=\"token key atrule\">commands</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ng test <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>progress false <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>watch false\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> build\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> johnpapa/angular<span class=\"token punctuation\">-</span>cli\n  <span class=\"token key atrule\">commands</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ng build <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>prod <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>base<span class=\"token punctuation\">-</span>href \"https<span class=\"token punctuation\">:</span>//miwtoo.github.io/drone<span class=\"token punctuation\">-</span>angular<span class=\"token punctuation\">-</span>git<span class=\"token punctuation\">-</span>test/\"\n\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> publish  \n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> plugins/gh<span class=\"token punctuation\">-</span>pages\n  <span class=\"token key atrule\">settings</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">from_secret</span><span class=\"token punctuation\">:</span> github_username\n    <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">from_secret</span><span class=\"token punctuation\">:</span> github_password    \n    <span class=\"token key atrule\">pages_directory</span><span class=\"token punctuation\">:</span> dist/drone<span class=\"token punctuation\">-</span>angular<span class=\"token punctuation\">-</span>git<span class=\"token punctuation\">-</span>test</code></pre></div>\n<p>ในที่นี้ในส่วนของ usrname และ password ของ github มีการใส่ secret ใว้เพื่อเป็นการที่เราไม่ต้องกรอก เข้าไปตรงๆ จะทำให้คนอื่นรู้รหัสเราได้ สามารถเข้าไปเพิ่มได้ที่ setting</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4f58faeeddd5ab64c4d22ead64a438f0/5a190/8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAAlUlEQVQoz5WRyQ0CMQxF0yISZSEK4EgdXKgBCuACaAbEOhNviYcfKhhbL1FyePqxk4gElFKnULGYaBLRTII9YLpPxNVK4iazqsXkTFWtJY+ZVNW9hsqQjEyAkwdtSAkLHbMI7h4pRKaRpH8M1/vn/SXMHE+YiUDe7i+L1WG5Pm52Z4xC/i3MoSXfXnTqBtA/8WPKHOAHHEEPUZ10HHEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/4f58faeeddd5ab64c4d22ead64a438f0/fcda8/8.png\"\n        srcset=\"/static/4f58faeeddd5ab64c4d22ead64a438f0/12f09/8.png 148w,\n/static/4f58faeeddd5ab64c4d22ead64a438f0/e4a3f/8.png 295w,\n/static/4f58faeeddd5ab64c4d22ead64a438f0/fcda8/8.png 590w,\n/static/4f58faeeddd5ab64c4d22ead64a438f0/5a190/8.png 800w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"4\">\n<li>จากนั้น push ขึ้น drone จะทำตามขั้นตอนที่เราเขียน script ใว้</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7b46f5ff74e733c9c6cc1744a552d36d/b2982/9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAACFklEQVQoz42S208TQRTG908wRk28pSjStApLVUS01tJIK1HjjVq1lZZiW4yvPmhMNPr3aFJUJKgNJAKtPGjCi+8qhd72Mjszu7OXtp5tK6BPbn6ZnPmy3/nO7CwnIoapLim6rLRXJiNCKFM1fTsaM5hutgugLXJrJWGjLP5arxZLws9iVUIUVKr9ZaYqK1eljbIgISKIqFKTMNFsc3G98mOtVKnJEsKipJCW+g9U1RWsAphqYIMC2tlmiRAMKlF1w7QsC0aCVyHZRt3C7sI2j9ApOBFjpJCqgATEVGaZVqP5H0+j0YQYTsaEMTsVAlVm5L9+fz+/AszOr8zkvrzLFbbz9lMBxDcf8wuFVRiHEwiGuHq9bpomtLw2+Xxn742Dg3f3nYzs4m/u5sf29Ie38IT3nojsOHp9+NYjWaFcjeJmA8ZotM3hqZeOoajn4lTvSNodmOz2xh2no11DMUcLKA6dvQctRmNPEJhFlfwxW23zEV/i1OWHfCjTF0y7/BOHvePdwLnW6h13+hL7B24Ho49tc1mRTcPUDbh3Bi3GMi8gbfCKbe4PZY6PPvCEMnww3TeSAvhQGvSuM7FL8acyohxWOxdLqAbJV5PPDgzc4YMp93Dy2IWUO3Df5U/2+BLO84keX9zpT7gCE5AciLTOrGnG5m8EH30hv/pq5nN2bml6bjlrs5TtFJ3t9Ifl17OLucVvRGW/ARS+D9GtN592AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/7b46f5ff74e733c9c6cc1744a552d36d/fcda8/9.png\"\n        srcset=\"/static/7b46f5ff74e733c9c6cc1744a552d36d/12f09/9.png 148w,\n/static/7b46f5ff74e733c9c6cc1744a552d36d/e4a3f/9.png 295w,\n/static/7b46f5ff74e733c9c6cc1744a552d36d/fcda8/9.png 590w,\n/static/7b46f5ff74e733c9c6cc1744a552d36d/b2982/9.png 729w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>อ้างอิง<br>\n<a href=\"https://docs.drone.io/installation/github/single-machine/\">https://docs.drone.io/installation/github/single-machine/</a></p>\n<p><a href=\"https://medium.com/@jccguimaraes/run-a-drone-ci-pipeline-locally-f4bfb4741c53\">https://medium.com/@jccguimaraes/run-a-drone-ci-pipeline-locally-f4bfb4741c53</a></p>","frontmatter":{"title":"ลองทำ CI/CD ด้วย Drone CI บนเครื่องตัวเอง","date":"June 24, 2019","description":""}}},"pageContext":{"slug":"/2019-06-24_ลองทำ-cicd-ดวย-drone-ci-บนเครองตวเอง/","previous":{"fields":{"slug":"/2018-06-23_การเขยน-relational-algebra-เมอเทยบกบ-sql/"},"frontmatter":{"title":"การเขียน Relational Algebra เมื่อเทียบกับ SQL"}},"next":{"fields":{"slug":"/golang-101-part-1/"},"frontmatter":{"title":"Golang 101 Part 1"}}}}}